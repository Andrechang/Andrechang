<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Notes On Caffe Development - Andrechang</title>
        <!-- meta -->
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="generator" content="Jekyll" />
        <meta name="author" content="Andrechang" />
        <meta name="description" content="Andrechang's blog" />
        <meta name="keywords" content="" />
        <!-- atom -->
        <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="http://andrechang.github.io/atom.xml" />
        <link rel="shortcut icon" href="/images/shortcut.jpg" type="image/x-icon" />
        <!-- font-awesome -->
        <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
        <link href='http://fonts.useso.com/css?family=Spirax' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="http://andrechang.github.io/css/syntax.css">
        <link rel="stylesheet" href="http://andrechang.github.io/css/main.css">

        
        
    </head>

    <body>
    <!-- <body  data-spy="scroll" data-target=".toc" data-offset="20"> -->
        <div class="head fn-clear">
            <div class="header">
                <h1 class="logo">
                    <a href="http://andrechang.github.io"><i class="icon-anchor"></i></a>
                </h1>
                <nav class="nav">
                    <ul>
                        
                        
                        
                        <li class="nav-item ">
                            <a href="http://andrechang.github.io/index.html">
                                HOME
                            </a>
                            
                        </li>
                        
                        
                        
                        <li class="nav-item ">
                            <a href="http://andrechang.github.io/categories.html">
                                CATEGORIES
                            </a>
                            
                        </li>
                        
                        
                        
                        <li class="nav-item ">
                            <a href="http://andrechang.github.io/about.html">
                                ABOUT ME
                            </a>
                            
                        </li>
                        
                        
                        
                        <li class="nav-item ">
                            <a href="http://andrechang.github.io/links.html">
                                LINKS
                            </a>
                            
                        </li>
                        
                    </ul>
                </nav>
                <div class="follow">
                    
                    <a href="/atom.xml" target="_blank"><i class="icon-rss"></i></a>
                    
                    <a href="https://www.facebook.com/" target="_blank"><i class="icon-facebook"></i></a>
                    
                    <a href="https://github.com/Andrechang/" target="_blank"><i class="icon-github-alt"></i></a>
                    
                </div>
            </div>
        </div>

        <div class="contain fn-clear">
            <div class="container fn-clear">
                <!-- toc -->
                <!-- 
                <div class="main-left">
                    <div id="toc"></div>
                </div>
                 -->

                <div class="main">
                    <div class="article article-post">
    <h2 class="title">Notes On Caffe Development</h2>
    <div class="info">
        <span class="info-title"><i class="icon-calendar"></i> Published: </span>
        <span class="info-date">10 Nov 2015</span>
        <span class="info-title"><i class="icon-folder-open"></i> Category: </span>
        <span class="info-link"><a href="http://andrechang.github.io/categories.html#deep_learning-ref" >deep_learning</a></span>
    </div>
    <div id="toc"></div>
    <h1 id="installation">Installation</h1>

<p><strong>Build Caffe in Windows with Visual Studio 2013 + CUDA 6.5 + OpenCV 2.4.9</strong></p>

<p><a href="https://initialneil.wordpress.com/2015/01/11/build-caffe-in-windows-with-visual-studio-2013-cuda-6-5-opencv-2-4-9/">https://initialneil.wordpress.com/2015/01/11/build-caffe-in-windows-with-visual-studio-2013-cuda-6-5-opencv-2-4-9/</a></p>

<p><strong>[2015-04-01] Build Caffe with Visual Studio 2013 on Windows 7 x64 using Cuda 7.0</strong></p>

<p><a href="https://mthust.github.io/2015/04/Build-Caffe-with-Visual-Studio-2013-on-Windows-7-x64-using-Cuda-7.0/">https://mthust.github.io/2015/04/Build-Caffe-with-Visual-Studio-2013-on-Windows-7-x64-using-Cuda-7.0/</a></p>

<p><strong>OpenCV Installation in Windows</strong></p>

<p><a href="http://docs.opencv.org/doc/tutorials/introduction/windows_install/windows_install.html">http://docs.opencv.org/doc/tutorials/introduction/windows_install/windows_install.html</a></p>

<h1 id="hdf5-vs-lmdb">HDF5 vs. LMDB</h1>

<p>HDF5:</p>

<p>Simple format to read/write.</p>

<p>The HDF5 files are always read entirely into memory, so can’t have any HDF5 files exceed memory capacity. But can easily split data into several HDF5 files though (just put several paths to h5 files in text file). Caffe dev group suggests that divide original large h5 data into small ones so that each h5 data fits &lt; 2 GB.</p>

<p>I/O performance won’t be nearly as good as LMDB.</p>

<p>Other DataLayers do prefetching in a separate thread, HDF5Layer does not.</p>

<p>Can only store float32 and float64 data - no uint8 means image data will be huge.</p>

<p>LMDB:</p>

<p>Uses memory-mapped files, giving much better I/O performance. Works well with large dataset.</p>

<p>Example:</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash">layer <span class="o">{</span>
  <span class="nb">type</span>: <span class="s2">"HDF5Data"</span>
  top: <span class="s2">"X"</span> <span class="c"># same name as given in create_dataset!</span>
  top: <span class="s2">"y"</span>
  hdf5_data_param <span class="o">{</span>
    <span class="nb">source</span>: <span class="s2">"train_h5_list.txt"</span> <span class="c"># do not give the h5 files directly, but the list.</span>
    batch_size: 32
  <span class="o">}</span>
  include <span class="o">{</span> phase:TRAIN <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<h1 id="create-lmdb-from-float-data">Create LMDB from float data</h1>

<p><a href="http://stackoverflow.com/questions/31774953/test-labels-for-regression-caffe-float-not-allowed">http://stackoverflow.com/questions/31774953/test-labels-for-regression-caffe-float-not-allowed</a></p>

<p><a href="https://github.com/BVLC/caffe/issues/1698#issuecomment-70211045">https://github.com/BVLC/caffe/issues/1698#issuecomment-70211045</a></p>

<p><strong>Reference</strong></p>

<p><a href="http://vision.stanford.edu/teaching/cs231n/slides/caffe_tutorial.pdf">http://vision.stanford.edu/teaching/cs231n/slides/caffe_tutorial.pdf</a></p>

<p><a href="http://deepdish.io/">http://deepdish.io/</a></p>

<p><a href="https://github.com/BVLC/caffe/issues/1470">https://github.com/BVLC/caffe/issues/1470</a></p>

<h1 id="lrpolicy-in-caffe">“lr_policy” in Caffe</h1>

<p>fixed: the learning rate is keped fixed throughout the learning process.</p>

<p>inv: the learning rate is decaying as ~1/T</p>

<p><img src="/assets/dl-materials/notes-on-caffe-dev/inv.png" /></p>

<p>step: the learning rate is piece-wise constant, dropping every X iterations</p>

<p><img src="/assets/dl-materials/notes-on-caffe-dev/step.png" /></p>

<p>multistep: piece-wise constant at arbitrary intervals</p>

<p><img src="/assets/dl-materials/notes-on-caffe-dev/multistep.png" /></p>

<p><strong>Reference</strong></p>

<p><a href="http://stackoverflow.com/questions/30033096/what-is-lr-policy-in-caffe">http://stackoverflow.com/questions/30033096/what-is-lr-policy-in-caffe</a></p>

<h1 id="iteration-loss-vs-train-net-loss">Iteration loss vs. Train Net loss</h1>

<p>The <code class="highlighter-rouge">net output #k</code> result is the output of the net for that particular iteration / batch 
while the <code class="highlighter-rouge">Iteration T, loss = X</code> output is smoothed across iterations according to the <code class="highlighter-rouge">average_loss</code> field.</p>

<h1 id="reading-and-notes">Reading and Notes</h1>

<p><strong>DIY Deep Learning for Vision: A Tutorial With Caffe 报告笔记</strong></p>

<p><a href="http://frank19900731.github.io/wx/2014-12-04-diy-deep-learning-for-vision-a-tutorial-with-caffe-bao-gao-bi-ji.html">http://frank19900731.github.io/wx/2014-12-04-diy-deep-learning-for-vision-a-tutorial-with-caffe-bao-gao-bi-ji.html</a></p>

<p><strong>Caffe_Manual(by Shicai Yang(@星空下的巫师))</strong></p>

<p><a href="https://github.com/shicai/Caffe_Manual">https://github.com/shicai/Caffe_Manual</a></p>

    <div class="bdsharebuttonbox">
        <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
        <a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a>
        <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
        <a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a>
        <a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a>
        <a href="#" class="bds_mail" data-cmd="mail" title="分享到邮件分享"></a>
        <a href="#" class="bds_more" data-cmd="more"></a>
    </div>
    <nav class="article-previous fn-clear">
        
        
    </nav>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES * * */
      var disqus_shortname = 'andrechang67';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

                </div>

                <div class="aside">
                    <div class="aside-contact">
                        <h4 class="title">About me</h4>
                        <div class="det fn-clear">
                            <div class="det-image">
                                <img src="/images/header.jpg" />
                            </div>
                            <div class="det-text">
                                <p>Ola</p>
                            </div>
                        </div>
                    </div>

                    <div class="aside-item">
                        <h4 class="title">Recent Posts</h4>
                        <ul class="list">
                            
                                <li><a href="http://andrechang.github.io/blog/development/2016/10/08/linux-tricks.html" title="My First Normal Post on Jekyll" rel="bookmark">My First Normal Post on Jekyll</a></li>
                            
                                <li><a href="http://andrechang.github.io/getting/started/2016/08/31/microzed-setup.html" title="MicroZedboard setup" rel="bookmark">MicroZedboard setup</a></li>
                            
                                <li><a href="http://andrechang.github.io/dualboot/2016/08/31/dualboot.html" title="dualboot setup" rel="bookmark">dualboot setup</a></li>
                            
                                <li><a href="http://andrechang.github.io/aprendizado/de/maquina/2016/08/04/Aprendendo-a-aprender.html" title="Aprendendo a aprender" rel="bookmark">Aprendendo a aprender</a></li>
                            
                                <li><a href="http://andrechang.github.io/vim/2016/05/31/vim.html" title="Good to know in Vim" rel="bookmark">Good to know in Vim</a></li>
                            
                                <li><a href="http://andrechang.github.io/computer_vision/2016/03/03/example.html" title="fgsfgsf" rel="bookmark">fgsfgsf</a></li>
                            
                        </ul>
                    </div>

                    <div class="aside-item">
                        <h4 class="title">Links</h4>
                        <ul class="list">
                            
                                
                            
                                
                            
                        </ul>
                    </div>
                </div>
            </div>
        </div>        
        
        <div class="foot">
            <div class="footer">
                <p>A blog template forked from <a href="https://github.com/zJiaJun/zJiaJun.github.io" target="_blank">zJiaJun</a>. Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>.</p>
            </div>
        </div>

        <script type="text/javascript" src="http://ajax.useso.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        
        
        
        <!-- mathjax -->
        <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
        <!-- Search in CSE home -->
        <script>
        (function() {
            var cx = '003287793477459687163:n59nxpgejxy';
            var gcse = document.createElement('script');
            gcse.type = 'text/javascript';
            gcse.async = true;
            gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
                '//cse.google.com/cse.js?cx=' + cx;
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(gcse, s);
        })();
        </script>
        <gcse:search></gcse:search>

        <!-- jekyll-table-of-contents -->
        
        <!-- <script src="http://andrechang.github.io/javascript/jquery-2.1.4.min.js" type="text/javascript"></script> -->
        <script src="http://andrechang.github.io/javascript/toc.js" type="text/javascript"></script>
        <!--
        <link rel="stylesheet" href="http://andrechang.github.io/css/bootstrap.min.css">
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
         -->

        <!-- Script to display table of content -->
        <script type="text/javascript">
        $(document).ready(function() {
            $('#toc').toc({ showEffect: 'slideDown' });
        }); </script>
        
    </body>
</html>